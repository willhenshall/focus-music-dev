---
description: Specification for audio streaming infrastructure, HLS implementation, and multi-CDN delivery architecture
---


# audio-delivery-architecture

HLS Bitrate Ladder Implementation:
- 4-tier quality ladder with dynamic switching:
  * Low: 32 kbps (48000 bandwidth)
  * Medium: 64 kbps (96000 bandwidth)
  * High: 96 kbps (144000 bandwidth)
  * Premium: 128 kbps (192000 bandwidth)
Importance Score: 90

CDN Strategy:
- Primary storage on Cloudflare R2
- Secondary backup on Supabase Storage
- Redundant distribution for high availability
- CDN-specific path structures:
  hls/<track_id>/[low|medium|high|premium]/segments
Importance Score: 85

Audio Processing Pipeline:
- Downloads source MP3s from R2 storage
- Transcodes to multiple bitrate variants
- Generates master and variant-specific HLS playlists
- Maintains processing state in database
- Handles partial failures with resumption capability
Importance Score: 80

iOS-Specific Optimizations:
- Custom HLS segment duration settings
- Radio-style crossfade implementation
- Platform-specific audio buffering
- Version tracking for crossfade implementation
Importance Score: 75

⚠️ PROTECTION WARNING:
- Audio engine files (enterpriseAudioEngine.ts and related) are HIGH-RISK
- Do NOT modify timing, crossfade, autoplay, or playback lifecycle unless explicitly requested
- See high-risk-areas.mdc for approval protocol

The architecture focuses on resilient audio delivery through multi-CDN distribution and adaptive bitrate streaming, with special consideration for iOS platform requirements.

$END$

 If you're using this file in context, clearly say in italics in one small line that "Context added by Giga audio-delivery-architecture" along with specifying exactly what information was used from this file in a human-friendly way, instead of using kebab-case use normal sentence case.